<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Absolute Zero</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --pixel-size: 2px;
            --main-bg: #1a1a1a;
            --text-color: #e0e0e0;
            --accent-color: #ffde59;
            --button-bg: #4a4a4a;
            --button-hover: #6a6a6a;
            --score-high: #4CAF50;
            --score-medium: #FFC107;
            --score-low: #FF5722;
            --score-zero: #2196F3;
        }

        body {
            background-color: var(--main-bg);
            color: var(--text-color);
            font-family: 'Press Start 2P', cursive;
            text-align: center;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .game-container {
            max-width: 900px;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 20px;
            border: 4px solid var(--accent-color);
            padding: 20px;
            box-shadow: 0 0 15px var(--accent-color);
            border-radius: 10px;
        }

        h1 {
            font-size: 2.5rem;
            text-shadow: 4px 4px 0px #000;
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--accent-color);
            text-shadow: 2px 2px 0px #000;
        }
        
        .game-summary {
            max-width: 600px;
            font-size: 0.8rem;
            line-height: 1.5;
            padding: 10px;
            margin-bottom: 20px;
            border: 2px dashed var(--text-color);
            border-radius: 5px;
        }

        .host-section {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .doom-host {
            position: relative;
            width: 120px;
            height: 150px;
            transform: scale(1.5);
        }

        .doom-host .body {
            position: absolute;
            background: #6a6a6a;
            width: 50px;
            height: 60px;
            left: 35px;
            bottom: 0;
            clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%, 0 70%, 10% 70%, 10% 100%, 90% 100%, 90% 70%, 100% 70%, 100% 100%, 0 100%);
        }

        .doom-host .head {
            position: absolute;
            background: #6a6a6a;
            width: 60px;
            height: 60px;
            top: 20px;
            left: 30px;
            border-radius: 5px;
            box-shadow: inset -5px -5px 0px #4a4a4a;
        }

        .doom-host .visor-frame {
            position: absolute;
            width: 40px;
            height: 15px;
            background: #000;
            top: 40px;
            left: 40px;
            border: 2px solid #fff;
            box-shadow: inset 2px 2px 0px #888;
        }

        .doom-host .visor-glass {
            position: absolute;
            width: 36px;
            height: 11px;
            background: #222;
            top: 42px;
            left: 42px;
            transition: background-color 0.5s ease;
        }
        
        .doom-host.happy .visor-glass { background: #4CAF50; }
        .doom-host.neutral .visor-glass { background: #FFC107; }
        .doom-host.angry .visor-glass { background: #FF0000; }

        .doom-host .mouth {
            position: absolute;
            background: #2a2a2a;
            width: 25px;
            height: 10px;
            bottom: 30px;
            left: 48px;
            border-radius: 2px;
            transition: all 0.5s ease;
        }

        .doom-host.happy .mouth {
            clip-path: polygon(0% 0%, 100% 0%, 100% 50%, 50% 100%, 0% 50%);
            background: #e0e0e0;
        }

        .doom-host.neutral .mouth {
            height: 5px;
            top: 80px;
            clip-path: none;
            background: #e0e0e0;
        }

        .doom-host.angry .mouth {
            clip-path: polygon(0% 50%, 50% 100%, 100% 50%, 100% 0%, 0% 0%);
            background: #e0e0e0;
        }

        .host-speech {
            background-color: var(--button-bg);
            border: 4px solid var(--text-color);
            padding: 15px;
            border-radius: 10px;
            position: relative;
            max-width: 60%;
            text-align: left;
            font-size: 0.9rem;
        }
        
        .host-speech::before {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 20px;
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 15px solid var(--text-color);
            filter: drop-shadow(0 4px 0px rgba(0,0,0,0.5));
        }

        .host-speech::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 20px;
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 15px solid var(--button-bg);
        }

        .game-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-items: center;
        }

        .thermometer-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            margin-top: 20px;
        }
        
        .thermometer-container {
            width: 80px;
            height: 250px;
            position: relative;
            background-color: #333;
            border: 3px solid var(--accent-color);
            border-radius: 40px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            transition: border-color 0.5s ease-in-out;
        }
        
        .thermometer-fill {
            width: 100%;
            height: 0%;
            background-color: var(--score-zero);
            transition: height 0.8s ease-in-out, background-color 0.8s ease-in-out;
            position: absolute;
            bottom: 0;
            left: 0;
        }

        .thermometer-container::after {
            content: '';
            position: absolute;
            bottom: -20px;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, var(--accent-color) 40%, transparent 45%);
            border-radius: 50%;
        }

        .thermometer-score-text {
            font-size: 2rem;
            color: var(--text-color);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            opacity: 0;
            transition: transform 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55), opacity 0.8s ease-in-out;
            text-shadow: 2px 2px 0px #000;
            z-index: 1;
        }

        .thermometer-score-text.show {
            transform: translate(-50%, 0) scale(1);
            opacity: 1;
        }

        .input-area {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .choice-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            width: 100%;
            max-width: 600px;
            margin-top: 10px;
        }
        
        @media (max-width: 600px) {
            .choice-buttons {
                grid-template-columns: 1fr;
            }
        }

        button {
            background-color: var(--button-bg);
            color: var(--text-color);
            border: 2px solid var(--accent-color);
            padding: 10px 20px;
            font-family: 'Press Start 2P', cursive;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.2s, box-shadow 0.2s, transform 0.1s;
        }
        
        .choice-buttons button {
            padding: 12px;
            font-size: 0.8em;
            word-wrap: break-word;
        }

        button:hover {
            background-color: var(--button-hover);
            box-shadow: 0 0 10px var(--accent-color);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            box-shadow: none;
        }

        .info-bar {
            background-color: var(--button-bg);
            border: 2px solid var(--accent-color);
            padding: 10px;
            border-radius: 5px;
            width: 100%;
            font-size: 0.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .player-info {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .player-score {
            background-color: var(--button-bg);
            border: 2px solid var(--accent-color);
            padding: 5px 10px;
            border-radius: 5px;
            min-width: 120px;
            text-align: left;
        }

        .start-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 30px;
            z-index: 100;
        }

        .score-summary {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid var(--accent-color);
            width: 80%;
            max-width: 600px;
        }

        .score-summary ul {
            list-style: none;
            padding: 0;
        }

        .score-summary li {
            font-size: 1.2rem;
            margin-bottom: 10px;
            padding: 5px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        @keyframes absolute-zero-pulse {
            0% { transform: scale(1); background-color: #2196F3; }
            50% { transform: scale(1.05); background-color: #0d47a1; }
            100% { transform: scale(1); background-color: #2196F3; }
        }

        .absolute-zero-flash {
            animation: absolute-zero-pulse 1s infinite;
        }
    </style>
</head>
<body>

<div class="game-container" id="game-container">
    <div id="start-screen" class="start-screen">
        <h1>Absolute Zero</h1>
        <p class="game-summary">
            Welcome, contestant. Your mission is to score points by answering questions. Each correct answer has a value. The closer you get to a zero-point answer, the greater the risk.
        </p>
        <div class="input-area">
            <button id="start-1p">1 Player (vs AI)</button>
            <button id="start-2p">2 Players</button>
            <button id="start-3p">3 Players</button>
        </div>
        <div id="player-name-inputs" style="display: none; flex-direction: column; gap: 10px;">
            <!-- Player name inputs will be dynamically added here -->
        </div>
        <button id="start-game-btn" style="display: none;">Start Game</button>
    </div>

    <h1 id="game-title">Absolute Zero</h1>

    <div class="host-section">
        <div class="doom-host" id="doom-host">
            <div class="body"></div>
            <div class="head"></div>
            <div class="visor-frame"></div>
            <div class="visor-glass"></div>
            <div class="mouth"></div>
        </div>
        <div class="host-speech" id="host-speech">
            Welcome to Absolute Zero!
        </div>
    </div>

    <div class="game-area">
        <div class="info-bar">
            <div id="round-stage">Round 1, Stage 1</div>
            <div id="current-player">Player 1's Turn</div>
        </div>

        <div class="question-display" id="question-display">
            The question will appear here...
        </div>

        <div class="input-area" id="input-area">
            <div id="choice-buttons" class="choice-buttons"></div>
        </div>

        <div class="thermometer-section">
            <div class="thermometer-container" id="thermometer-container">
                <div class="thermometer-fill" id="thermometer-fill"></div>
                <div class="thermometer-score-text" id="thermometer-score-text"></div>
            </div>
        </div>

        <div class="player-info" id="player-info-container">
            <!-- Player scores will be dynamically added here -->
        </div>

        <button id="next-round-btn" style="display: none;">Next Round</button>
    </div>
</div>

<script>
    // Game data - expanded for multiple choice
    const gameData = [
        {
            theme: 'Geography',
            question: "Name a country in South America.",
            answers: [
                { answer: "Brazil", score: 80 }, { answer: "Argentina", score: 65 }, { answer: "Colombia", score: 40 },
                { answer: "Peru", score: 25 }, { answer: "Ecuador", score: 12 }, { answer: "Uruguay", score: 5 },
                { answer: "Paraguay", score: 0 }, { answer: "Suriname", score: 0 }, { answer: "Guyana", score: 0 },
                { answer: "French Guiana", score: 0 }, { answer: "Bolivia", score: 1 }, { answer: "Chile", score: 20 },
                { answer: "Venezuela", score: 10 }, { answer: "Panama", score: 0 }, { answer: "Costa Rica", score: 0 },
                { answer: "Mexico", score: 0 }, { answer: "Spain", score: 0 }, { answer: "Portugal", score: 0 },
                { answer: "Nigeria", score: 0 }, { answer: "Egypt", score: 0 }, { answer: "China", score: 0 },
                { answer: "Australia", score: 0 }, { answer: "Canada", score: 0 }, { answer: "USA", score: 0 },
                { answer: "Honduras", score: 0 }, { answer: "Cuba", score: 0 }, { answer: "Haiti", score: 0 }
            ]
        },
        {
            theme: 'Geography',
            question: "Name a city in Asia.",
            answers: [
                { answer: "Tokyo", score: 90 }, { answer: "Seoul", score: 85 }, { answer: "Beijing", score: 70 },
                { answer: "Mumbai", score: 60 }, { answer: "Bangkok", score: 55 }, { answer: "Dubai", score: 45 },
                { answer: "Singapore", score: 30 }, { answer: "Jerusalem", score: 20 }, { answer: "Kathmandu", score: 10 },
                { answer: "Male", score: 5 }, { answer: "Dhaka", score: 1 }, { answer: "Naypyidaw", score: 0 },
                { answer: "Vienna", score: 0 }, { answer: "Cairo", score: 0 }, { answer: "Lagos", score: 0 },
                { answer: "Toronto", score: 0 }, { answer: "Brasilia", score: 0 }, { answer: "Sydney", score: 0 },
                { answer: "Oslo", score: 0 }, { answer: "Lisbon", score: 0 }, { answer: "Dublin", score: 0 },
                { answer: "Buenos Aires", score: 0 }, { answer: "Mexico City", score: 0 }, { answer: "Lima", score: 0 }
            ]
        },
        {
            theme: 'Movies',
            question: "Name a movie directed by Christopher Nolan.",
            answers: [
                { answer: "Inception", score: 95 }, { answer: "The Dark Knight", score: 90 }, { answer: "Oppenheimer", score: 85 },
                { answer: "Interstellar", score: 80 }, { answer: "Dunkirk", score: 70 }, { answer: "Memento", score: 60 },
                { answer: "The Prestige", score: 55 }, { answer: "Batman Begins", score: 45 }, { answer: "Tenet", score: 30 },
                { answer: "The Dark Knight Rises", score: 20 }, { answer: "Following", score: 10 }, { answer: "Insomnia", score: 5 },
                { answer: "Pulp Fiction", score: 0 }, { answer: "Kill Bill", score: 0 }, { answer: "Parasite", score: 0 },
                { answer: "Mad Max: Fury Road", score: 0 }, { answer: "The Godfather", score: 0 }, { answer: "2001: A Space Odyssey", score: 0 }
            ]
        },
        {
            theme: 'Movies',
            question: "Name a famous animated movie.",
            answers: [
                { answer: "The Lion King", score: 90 }, { answer: "Toy Story", score: 85 }, { answer: "Spirited Away", score: 80 },
                { answer: "Frozen", score: 75 }, { answer: "Finding Nemo", score: 60 }, { answer: "Up", score: 50 },
                { answer: "Shrek", score: 45 }, { answer: "Moana", score: 35 }, { answer: "Coco", score: 25 },
                { answer: "Inside Out", score: 15 }, { answer: "Zootopia", score: 10 }, { answer: "How to Train Your Dragon", score: 5 },
                { answer: "The Simpsons Movie", score: 1 }, { answer: "Fantastic Mr. Fox", score: 0 }, { answer: "Akira", score: 0 }
            ]
        },
        {
            theme: 'Sports',
            question: "Name a sport played with a ball.",
            answers: [
                { answer: "Football (Soccer)", score: 95 }, { answer: "Basketball", score: 90 }, { answer: "Tennis", score: 80 },
                { answer: "Baseball", score: 75 }, { answer: "Rugby", score: 60 }, { answer: "Volleyball", score: 50 },
                { answer: "Golf", score: 40 }, { answer: "Cricket", score: 30 }, { answer: "Handball", score: 20 },
                { answer: "Water Polo", score: 15 }, { answer: "Polo", score: 10 }, { answer: "Snooker", score: 5 },
                { answer: "Bocce", score: 1 }, { answer: "Table Tennis", score: 0 }, { answer: "Archery", score: 0 },
                { answer: "Swimming", score: 0 }, { answer: "Fencing", score: 0 }, { answer: "Skiing", score: 0 }
            ]
        },
        {
            theme: 'Sports',
            question: "Name a famous tennis player.",
            answers: [
                { answer: "Roger Federer", score: 95 }, { answer: "Rafael Nadal", score: 90 }, { answer: "Serena Williams", score: 85 },
                { answer: "Novak Djokovic", score: 80 }, { answer: "Venus Williams", score: 70 }, { answer: "Andy Murray", score: 60 },
                { answer: "Pete Sampras", score: 50 }, { answer: "Andre Agassi", score: 40 }, { answer: "Maria Sharapova", score: 30 },
                { answer: "Naomi Osaka", score: 20 }, { answer: "Daniil Medvedev", score: 10 }, { answer: "Carlos Alcaraz", score: 5 },
                { answer: "Bjorn Borg", score: 1 }, { answer: "Michael Jordan", score: 0 }, { answer: "LeBron James", score: 0 },
                { answer: "Tiger Woods", score: 0 }, { answer: "Usain Bolt", score: 0 }, { answer: "Tom Brady", score: 0 }
            ]
        },
        {
            theme: 'Science',
            question: "Name a planet in our solar system.",
            answers: [
                { answer: "Jupiter", score: 90 }, { answer: "Saturn", score: 85 }, { answer: "Mars", score: 80 },
                { answer: "Venus", score: 70 }, { answer: "Neptune", score: 60 }, { answer: "Uranus", score: 55 },
                { answer: "Mercury", score: 50 }, { answer: "Earth", score: 100 }, { answer: "Pluto", score: 0 },
                { answer: "Eris", score: 0 }, { answer: "Vesta", score: 0 }, { answer: "Moon", score: 0 },
                { answer: "Sun", score: 0 }, { answer: "Alpha Centauri", score: 0 }, { answer: "Kepler-186f", score: 0 }
            ]
        },
        {
            theme: 'Science',
            question: "Name a human body organ.",
            answers: [
                { answer: "Heart", score: 95 }, { answer: "Brain", score: 90 }, { answer: "Lungs", score: 85 },
                { answer: "Liver", score: 80 }, { answer: "Kidneys", score: 70 }, { answer: "Stomach", score: 60 },
                { answer: "Pancreas", score: 50 }, { answer: "Spleen", score: 40 }, { answer: "Gallbladder", score: 30 },
                { answer: "Thyroid", score: 20 }, { answer: "Appendix", score: 10 }, { answer: "Tonsils", score: 5 },
                { answer: "Cornea", score: 1 }, { answer: "Hair", score: 0 }, { answer: "Finger", score: 0 },
                { answer: "Earlobe", score: 0 }, { answer: "Nail", score: 0 }, { answer: "Tooth", score: 0 }
            ]
        },
        {
            theme: 'History',
            question: "Name a famous Roman Emperor.",
            answers: [
                { answer: "Augustus", score: 90 }, { answer: "Julius Caesar", score: 95 }, { answer: "Nero", score: 70 },
                { answer: "Caligula", score: 65 }, { answer: "Constantine", score: 50 }, { answer: "Hadrian", score: 40 },
                { answer: "Diocletian", score: 30 }, { answer: "Trajan", score: 25 }, { answer: "Marcus Aurelius", score: 20 },
                { answer: "Commodus", score: 15 }, { answer: "Vespasian", score: 10 }, { answer: "Tiberius", score: 5 },
                { answer: "Cicero", score: 0 }, { answer: "Hannibal", score: 0 }, { answer: "Socrates", score: 0 },
                { answer: "Cleopatra", score: 0 }, { answer: "Alexander the Great", score: 0 }
            ]
        },
        {
            theme: 'History',
            question: "Name a famous ancient civilization.",
            answers: [
                { answer: "Ancient Egypt", score: 95 }, { answer: "Ancient Greece", score: 90 }, { answer: "Ancient Rome", score: 85 },
                { answer: "Mesopotamia", score: 75 }, { answer: "Indus Valley Civilization", score: 60 }, { answer: "Maya Civilization", score: 50 },
                { answer: "Inca Empire", score: 40 }, { answer: "Aztec Empire", score: 30 }, { answer: "Persian Empire", score: 25 },
                { answer: "Han Dynasty China", score: 15 }, { answer: "Phoenicia", score: 10 }, { answer: "Hittite Empire", score: 5 },
                { answer: "Viking Age", score: 0 }, { answer: "Mongol Empire", score: 0 }, { answer: "British Empire", score: 0 }
            ]
        },
        {
            theme: 'Art',
            question: "Name a famous painter.",
            answers: [
                { answer: "Leonardo da Vinci", score: 95 }, { answer: "Michelangelo", score: 90 }, { answer: "Vincent van Gogh", score: 85 },
                { answer: "Pablo Picasso", score: 80 }, { answer: "Claude Monet", score: 75 }, { answer: "Salvador Dalí", score: 60 },
                { answer: "Frida Kahlo", score: 50 }, { answer: "Rembrandt", score: 40 }, { answer: "Andy Warhol", score: 30 },
                { answer: "Jackson Pollock", score: 20 }, { answer: "Gustav Klimt", score: 10 }, { answer: "Titian", score: 5 },
                { answer: "Banksy", score: 1 }, { answer: "Beethoven", score: 0 }, { answer: "Mozart", score: 0 },
                { answer: "Shakespeare", score: 0 }, { answer: "Hemingway", score: 0 }
            ]
        },
        {
            theme: 'Art',
            question: "Name a famous art movement.",
            answers: [
                { answer: "Renaissance", score: 90 }, { answer: "Impressionism", score: 85 }, { answer: "Cubism", score: 80 },
                { answer: "Surrealism", score: 75 }, { answer: "Baroque", score: 60 }, { answer: "Pop Art", score: 50 },
                { answer: "Expressionism", score: 40 }, { answer: "Romanticism", score: 30 }, { answer: "Abstract Expressionism", score: 20 },
                { answer: "Fauvism", score: 10 }, { answer: "Dadaism", score: 5 }, { answer: "Futurism", score: 1 },
                { answer: "Post-Modernism", score: 0 }, { answer: "Gothic", score: 0 }, { answer: "Romanesque", score: 0 }
            ]
        },
        {
            theme: 'Literature',
            question: "Name a famous book from the 20th century.",
            answers: [
                { answer: "The Great Gatsby", score: 95 }, { answer: "To Kill a Mockingbird", score: 90 }, { answer: "1984", score: 85 },
                { answer: "The Catcher in the Rye", score: 80 }, { answer: "The Hobbit", score: 75 }, { answer: "The Lord of the Rings", score: 65 },
                { answer: "The Grapes of Wrath", score: 55 }, { answer: "One Hundred Years of Solitude", score: 45 }, { answer: "Animal Farm", score: 35 },
                { answer: "Brave New World", score: 25 }, { answer: "Of Mice and Men", score: 15 }, { answer: "Fahrenheit 451", score: 10 },
                { answer: "Slaughterhouse-Five", score: 5 }, { answer: "Ulysses", score: 1 }, { answer: "Moby Dick", score: 0 },
                { answer: "Frankenstein", score: 0 }, { answer: "The Odyssey", score: 0 }, { answer: "Don Quixote", score: 0 }
            ]
        },
        {
            theme: 'Literature',
            question: "Name a famous play by William Shakespeare.",
            answers: [
                { answer: "Hamlet", score: 95 }, { answer: "Romeo and Juliet", score: 90 }, { answer: "Macbeth", score: 85 },
                { answer: "Othello", score: 60 }, { answer: "King Lear", score: 50 }, { answer: "Julius Caesar", score: 40 },
                { answer: "A Midsummer Night's Dream", score: 70 }, { answer: "The Tempest", score: 30 }, { answer: "Twelfth Night", score: 20 },
                { answer: "The Taming of the Shrew", score: 10 }, { answer: "Henry V", score: 5 }, { answer: "Much Ado About Nothing", score: 1 },
                { answer: "The Importance of Being Earnest", score: 0 }, { answer: "Death of a Salesman", score: 0 }
            ]
        },
        {
            theme: 'Comics',
            question: "Name a superhero from Marvel.",
            answers: [
                { answer: "Iron Man", score: 95 }, { answer: "Captain America", score: 90 }, { answer: "Spider-Man", score: 85 },
                { answer: "Hulk", score: 75 }, { answer: "Thor", score: 60 }, { answer: "Black Widow", score: 50 },
                { answer: "Black Panther", score: 45 }, { answer: "Doctor Strange", score: 35 }, { answer: "Wolverine", score: 25 },
                { answer: "Deadpool", score: 15 }, { answer: "Captain Marvel", score: 10 }, { answer: "Ant-Man", score: 5 },
                { answer: "Daredevil", score: 1 }, { answer: "Superman", score: 0 }, { answer: "Batman", score: 0 },
                { answer: "Wonder Woman", score: 0 }, { answer: "The Flash", score: 0 }
            ]
        },
        {
            theme: 'Comics',
            question: "Name a superhero team.",
            answers: [
                { answer: "The Avengers", score: 95 }, { answer: "Justice League", score: 90 }, { answer: "X-Men", score: 80 },
                { answer: "Fantastic Four", score: 70 }, { answer: "Teen Titans", score: 55 }, { answer: "Guardians of the Galaxy", score: 40 },
                { answer: "The Incredibles", score: 30 }, { answer: "Suicide Squad", score: 20 }, { answer: "The Defenders", score: 15 },
                { answer: "The League of Extraordinary Gentlemen", score: 5 }, { answer: "Power Rangers", score: 0 },
                { answer: "G.I. Joe", score: 0 }, { answer: "Transformers", score: 0 }
            ]
        },
        {
            theme: 'Mythology',
            question: "Name a Greek god or goddess from the Olympian pantheon.",
            answers: [
                { answer: "Zeus", score: 95 }, { answer: "Hera", score: 90 }, { answer: "Poseidon", score: 85 },
                { answer: "Hades", score: 70 }, { answer: "Apollo", score: 60 }, { answer: "Artemis", score: 50 },
                { answer: "Dionysus", score: 35 }, { answer: "Hephaestus", score: 20 }, { answer: "Hestia", score: 10 },
                { answer: "Ares", score: 5 }, { answer: "Eris", score: 0 }, { answer: "Prometheus", score: 0 }
            ]
        },
        {
            theme: 'Mythology',
            question: "Name a mythical creature.",
            answers: [
                { answer: "Dragon", score: 95 }, { answer: "Unicorn", score: 90 }, { answer: "Griffin", score: 85 },
                { answer: "Minotaur", score: 70 }, { answer: "Sphinx", score: 60 }, { answer: "Phoenix", score: 50 },
                { answer: "Centaur", score: 40 }, { answer: "Kraken", score: 30 }, { answer: "Hydra", score: 20 },
                { answer: "Basilisk", score: 15 }, { answer: "Gorgon", score: 10 }, { answer: "Siren", score: 5 },
                { answer: "Mermaid", score: 1 }, { answer: "Gnome", score: 0 }, { answer: "Elf", score: 0 }
            ]
        },
        {
            theme: 'World Wonders',
            question: "Name one of the Seven Wonders of the Ancient World.",
            answers: [
                { answer: "Great Pyramid of Giza", score: 95 }, { answer: "Hanging Gardens of Babylon", score: 80 },
                { answer: "Statue of Zeus at Olympia", score: 70 }, { answer: "Temple of Artemis at Ephesus", score: 55 },
                { answer: "Mausoleum at Halicarnassus", score: 40 }, { answer: "Colossus of Rhodes", score: 25 },
                { answer: "Lighthouse of Alexandria", score: 10 }, { answer: "Taj Mahal", score: 0 }, { answer: "Colosseum", score: 0 },
                { answer: "Machu Picchu", score: 0 }, { answer: "Christ the Redeemer", score: 0 }, { answer: "Great Wall of China", score: 0 }
            ]
        },
        {
            theme: 'World Wonders',
            question: "Name a famous monument or landmark.",
            answers: [
                { answer: "Eiffel Tower", score: 95 }, { answer: "Statue of Liberty", score: 90 }, { answer: "Great Wall of China", score: 85 },
                { answer: "Taj Mahal", score: 80 }, { answer: "Colosseum", score: 75 }, { answer: "Stonehenge", score: 60 },
                { answer: "Machu Picchu", score: 55 }, { answer: "Christ the Redeemer", score: 45 }, { answer: "The Louvre", score: 30 },
                { answer: "Sydney Opera House", score: 20 }, { answer: "Mount Rushmore", score: 10 }, { answer: "Easter Island Statues", score: 5 },
                { answer: "Big Ben", score: 1 }, { answer: "Golden Gate Bridge", score: 0 }, { answer: "Leaning Tower of Pisa", score: 0 }
            ]
        },
        {
            theme: 'Technology',
            question: "Name a famous programming language.",
            answers: [
                { answer: "Python", score: 95 }, { answer: "JavaScript", score: 90 }, { answer: "Java", score: 80 },
                { answer: "C++", score: 70 }, { answer: "Ruby", score: 55 }, { answer: "Swift", score: 40 },
                { answer: "Go", score: 25 }, { answer: "Rust", score: 10 }, { answer: "Haskell", score: 0 },
                { answer: "Erlang", score: 0 }, { answer: "COBOL", score: 0 }, { answer: "BASIC", score: 0 }
            ]
        },
        {
            theme: 'Technology',
            question: "Name a major social media platform.",
            answers: [
                { answer: "Facebook", score: 95 }, { answer: "Instagram", score: 90 }, { answer: "TikTok", score: 85 },
                { answer: "X (formerly Twitter)", score: 80 }, { answer: "YouTube", score: 75 }, { answer: "Snapchat", score: 60 },
                { answer: "LinkedIn", score: 50 }, { answer: "Pinterest", score: 40 }, { answer: "Reddit", score: 30 },
                { answer: "Twitch", score: 20 }, { answer: "Discord", score: 15 }, { answer: "WhatsApp", score: 10 },
                { answer: "MySpace", score: 0 }, { answer: "Friendster", score: 0 }, { answer: "AOL Instant Messenger", score: 0 }
            ]
        },
        {
            theme: 'Animals',
            question: "Name a species of large cat.",
            answers: [
                { answer: "Lion", score: 95 }, { answer: "Tiger", score: 90 }, { answer: "Leopard", score: 85 },
                { answer: "Jaguar", score: 75 }, { answer: "Cheetah", score: 60 }, { answer: "Puma", score: 50 },
                { answer: "Snow Leopard", score: 40 }, { answer: "Clouded Leopard", score: 25 }, { answer: "Ocelot", score: 10 },
                { answer: "Domestic Cat", score: 0 }, { answer: "Panda", score: 0 }, { answer: "Koala", score: 0 }
            ]
        },
        {
            theme: 'Animals',
            question: "Name a bird that cannot fly.",
            answers: [
                { answer: "Penguin", score: 95 }, { answer: "Ostrich", score: 90 }, { answer: "Emu", score: 85 },
                { answer: "Kiwi", score: 75 }, { answer: "Cassowary", score: 60 }, { answer: "Rhea", score: 50 },
                { answer: "Dodo", score: 40 }, { answer: "Kagu", score: 10 }, { answer: "Turkey", score: 0 },
                { answer: "Chicken", score: 0 }, { answer: "Duck", score: 0 }, { answer: "Goose", score: 0 }
            ]
        },
        {
            theme: 'Food',
            question: "Name a type of pasta.",
            answers: [
                { answer: "Spaghetti", score: 95 }, { answer: "Fettuccine", score: 90 }, { answer: "Lasagna", score: 85 },
                { answer: "Penne", score: 80 }, { answer: "Ravioli", score: 70 }, { answer: "Macaroni", score: 60 },
                { answer: "Linguine", score: 50 }, { answer: "Gnocchi", score: 40 }, { answer: "Orzo", score: 30 },
                { answer: "Tortellini", score: 20 }, { answer: "Rigatoni", score: 10 }, { answer: "Farfalle", score: 5 },
                { answer: "Croissant", score: 0 }, { answer: "Bagel", score: 0 }, { answer: "Taco", score: 0 }
            ]
        },
        {
            theme: 'Food',
            question: "Name a type of cheese.",
            answers: [
                { answer: "Cheddar", score: 95 }, { answer: "Mozzarella", score: 90 }, { answer: "Swiss", score: 85 },
                { answer: "Provolone", score: 80 }, { answer: "Gouda", score: 70 }, { answer: "Brie", score: 60 },
                { answer: "Feta", score: 50 }, { answer: "Gorgonzola", score: 40 }, { answer: "Ricotta", score: 30 },
                { answer: "Colby", score: 20 }, { answer: "Muenster", score: 10 }, { answer: "Havarti", score: 5 },
                { answer: "Pepperoni", score: 0 }, { answer: "Sausage", score: 0 }, { answer: "Bread", score: 0 }
            ]
        },
        {
            theme: 'Music',
            question: "Name a famous rock band.",
            answers: [
                { answer: "The Beatles", score: 95 }, { answer: "Led Zeppelin", score: 90 }, { answer: "Queen", score: 85 },
                { answer: "The Rolling Stones", score: 80 }, { answer: "AC/DC", score: 75 }, { answer: "Nirvana", score: 65 },
                { answer: "Guns N' Roses", score: 55 }, { answer: "Metallica", score: 45 }, { answer: "Pink Floyd", score: 35 },
                { answer: "U2", score: 25 }, { answer: "Red Hot Chili Peppers", score: 15 }, { answer: "Green Day", score: 5 },
                { answer: "Nsync", score: 0 }, { answer: "Backstreet Boys", score: 0 }, { answer: "Spice Girls", score: 0 }
            ]
        },
        {
            theme: 'Music',
            question: "Name a famous classical composer.",
            answers: [
                { answer: "Ludwig van Beethoven", score: 95 }, { answer: "Wolfgang Amadeus Mozart", score: 90 }, { answer: "Johann Sebastian Bach", score: 85 },
                { answer: "Pyotr Ilyich Tchaikovsky", score: 80 }, { answer: "Frédéric Chopin", score: 70 }, { answer: "Antonio Vivaldi", score: 60 },
                { answer: "Richard Wagner", score: 50 }, { answer: "Franz Schubert", score: 40 }, { answer: "Joseph Haydn", score: 30 },
                { answer: "George Frideric Handel", score: 20 }, { answer: "Claude Debussy", score: 10 }, { answer: "Igor Stravinsky", score: 5 },
                { answer: "Taylor Swift", score: 0 }, { answer: "Eminem", score: 0 }, { answer: "Drake", score: 0 }
            ]
        },
        {
            theme: 'Inventions',
            question: "Name a famous invention.",
            answers: [
                { answer: "Light Bulb", score: 95 }, { answer: "Telephone", score: 90 }, { answer: "Printing Press", score: 85 },
                { answer: "Internet", score: 80 }, { answer: "Steam Engine", score: 75 }, { answer: "Vaccine", score: 60 },
                { answer: "Automobile", score: 50 }, { answer: "Airplane", score: 40 }, { answer: "Penicillin", score: 30 },
                { answer: "Compass", score: 20 }, { answer: "Microscope", score: 10 }, { answer: "Radio", score: 5 },
                { answer: "T-shirt", score: 0 }, { answer: "Coffee", score: 0 }, { answer: "Pencil", score: 0 }
            ]
        },
        {
            theme: 'Inventions',
            question: "Name a famous scientist.",
            answers: [
                { answer: "Albert Einstein", score: 95 }, { answer: "Isaac Newton", score: 90 }, { answer: "Marie Curie", score: 85 },
                { answer: "Charles Darwin", score: 80 }, { answer: "Stephen Hawking", score: 75 }, { answer: "Galileo Galilei", score: 65 },
                { answer: "Nikola Tesla", score: 55 }, { answer: "Louis Pasteur", score: 45 }, { answer: "Thomas Edison", score: 35 },
                { answer: "Rosalind Franklin", score: 25 }, { answer: "Alan Turing", score: 15 }, { answer: "Jane Goodall", score: 5 },
                { answer: "Leonardo da Vinci", score: 0 }, { answer: "Shakespeare", score: 0 }, { answer: "Plato", score: 0 }
            ]
        },
        {
            theme: 'Astronomy',
            question: "Name a type of star.",
            answers: [
                { answer: "Red Giant", score: 95 }, { answer: "White Dwarf", score: 90 }, { answer: "Neutron Star", score: 85 },
                { answer: "Supernova", score: 80 }, { answer: "Main-Sequence Star", score: 70 }, { answer: "Brown Dwarf", score: 60 },
                { answer: "Black Hole", score: 50 }, { answer: "Pulsar", score: 40 }, { answer: "Quasar", score: 30 },
                { answer: "Magnetar", score: 20 }, { answer: "Blue Giant", score: 10 }, { answer: "Red Dwarf", score: 5 },
                { answer: "Meteor", score: 0 }, { answer: "Comet", score: 0 }, { answer: "Asteroid", score: 0 }
            ]
        },
        {
            theme: 'Astronomy',
            question: "Name a constellation.",
            answers: [
                { answer: "Ursa Major", score: 95 }, { answer: "Orion", score: 90 }, { answer: "Cassiopeia", score: 85 },
                { answer: "Leo", score: 80 }, { answer: "Andromeda", score: 75 }, { answer: "Lyra", score: 65 },
                { answer: "Aquarius", score: 55 }, { answer: "Scorpius", score: 45 }, { answer: "Gemini", score: 35 },
                { answer: "Taurus", score: 25 }, { answer: "Virgo", score: 15 }, { answer: "Pegasus", score: 5 },
                { answer: "The Big Dipper", score: 0 }, { answer: "The Little Dipper", score: 0 }, { answer: "The Milky Way", score: 0 }
            ]
        },
        {
            theme: 'World Capitals',
            question: "Name a European capital city.",
            answers: [
                { answer: "Paris", score: 95 }, { answer: "London", score: 90 }, { answer: "Rome", score: 85 },
                { answer: "Berlin", score: 80 }, { answer: "Madrid", score: 75 }, { answer: "Amsterdam", score: 65 },
                { answer: "Vienna", score: 55 }, { answer: "Prague", score: 45 }, { answer: "Budapest", score: 35 },
                { answer: "Stockholm", score: 25 }, { answer: "Athens", score: 15 }, { answer: "Lisbon", score: 5 },
                { answer: "Oslo", score: 1 }, { answer: "Helsinki", score: 0 }, { answer: "Dublin", score: 0 },
                { answer: "Moscow", score: 0 }, { answer: "Kyiv", score: 0 }, { answer: "Warsaw", score: 0 }
            ]
        },
        {
            theme: 'World Capitals',
            question: "Name a North American capital city.",
            answers: [
                { answer: "Washington, D.C.", score: 95 }, { answer: "Ottawa", score: 90 }, { answer: "Mexico City", score: 85 },
                { answer: "Havana", score: 75 }, { answer: "Kingston", score: 60 }, { answer: "Nassau", score: 50 },
                { answer: "Panama City", score: 40 }, { answer: "Guatemala City", score: 30 }, { answer: "Tegucigalpa", score: 20 },
                { answer: "San José", score: 10 }, { answer: "Port-au-Prince", score: 5 }, { answer: "Belmopan", score: 1 },
                { answer: "New York City", score: 0 }, { answer: "Los Angeles", score: 0 }, { answer: "Toronto", score: 0 },
                { answer: "Vancouver", score: 0 }
            ]
        },
        {
            theme: 'Games',
            question: "Name a classic arcade game.",
            answers: [
                { answer: "Pac-Man", score: 95 }, { answer: "Space Invaders", score: 90 }, { answer: "Donkey Kong", score: 85 },
                { answer: "Asteroids", score: 80 }, { answer: "Galaga", score: 70 }, { answer: "Centipede", score: 60 },
                { answer: "Frogger", score: 50 }, { answer: "Street Fighter", score: 40 }, { answer: "Tetris", score: 30 },
                { answer: "Q*bert", score: 20 }, { answer: "Missile Command", score: 10 }, { answer: "Tempest", score: 5 },
                { answer: "Fortnite", score: 0 }, { answer: "Call of Duty", score: 0 }, { answer: "Minecraft", score: 0 }
            ]
        },
        {
            theme: 'Games',
            question: "Name a famous video game franchise.",
            answers: [
                { answer: "Super Mario Bros.", score: 95 }, { answer: "The Legend of Zelda", score: 90 }, { answer: "Pokémon", score: 85 },
                { answer: "Final Fantasy", score: 80 }, { answer: "Grand Theft Auto", score: 75 }, { answer: "Call of Duty", score: 65 },
                { answer: "Minecraft", score: 55 }, { answer: "The Elder Scrolls", score: 45 }, { answer: "Halo", score: 35 },
                { answer: "World of Warcraft", score: 25 }, { answer: "Metal Gear Solid", score: 15 }, { answer: "Sonic the Hedgehog", score: 5 },
                { answer: "My Little Pony", score: 0 }, { answer: "LEGO", score: 0 }, { answer: "Barbie", score: 0 }
            ]
        }
    ];

    // --- Game Variables and UI Elements ---
    const startScreen = document.getElementById('start-screen');
    const start1pBtn = document.getElementById('start-1p');
    const start2pBtn = document.getElementById('start-2p');
    const start3pBtn = document.getElementById('start-3p');
    const playerNameInputsDiv = document.getElementById('player-name-inputs');
    const startGameBtn = document.getElementById('start-game-btn');
    const hostSpeech = document.getElementById('host-speech');
    const roundStageText = document.getElementById('round-stage');
    const currentPlayerText = document.getElementById('current-player');
    const questionDisplay = document.getElementById('question-display');
    const choiceButtonsDiv = document.getElementById('choice-buttons');
    const thermometerScoreText = document.getElementById('thermometer-score-text');
    const thermometerContainer = document.getElementById('thermometer-container');
    const thermometerFill = document.getElementById('thermometer-fill');
    const playerInfoContainer = document.getElementById('player-info-container');
    const nextRoundBtn = document.getElementById('next-round-btn');
    const gameContainer = document.getElementById('game-container');
    const doomHost = document.getElementById('doom-host');

    let game = {
        players: [],
        isAIGame: false,
        currentPlayerIndex: 0,
        currentStage: 1,
        currentRound: 1,
        currentQuestion: null,
        usedQuestions: new Set(),
        shuffledGameData: []
    };

    // --- Core Game Functions ---

    function setupPlayers(playerCount) {
        game.players = [];
        for (let i = 0; i < playerCount; i++) {
            game.players.push({
                name: `Player ${i + 1}`,
                score: 0
            });
        }
        if (game.isAIGame) {
            game.players.push({ name: "AI", score: 0 });
        }
        updatePlayerInfoUI();
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }
    
    function getColorForScore(score) {
        const clampedScore = Math.max(0, Math.min(100, score));
        let r, g, b;
        let p = clampedScore / 100;

        if (p < 0.5) {
            const p2 = p * 2;
            r = Math.floor(255 * p2);
            g = Math.floor(255 * p2);
            b = Math.floor(255 * (1 - p2) + 68 * p2);
        } else {
            const p2 = (p - 0.5) * 2;
            r = 255;
            g = Math.floor(255 * (1 - p2));
            b = 0;
        }

        return `rgb(${r}, ${g}, ${b})`;
    }

    function sanitizeNameForId(name) {
        return name.replace(/\s+/g, '-').replace(/[()]/g, '');
    }

    function updatePlayerInfoUI() {
        playerInfoContainer.innerHTML = '';
        game.players.forEach(player => {
            const playerDiv = document.createElement('div');
            playerDiv.className = 'player-score';
            playerDiv.innerHTML = `<strong>${player.name}:</strong> <span id="score-${sanitizeNameForId(player.name)}">${player.score}</span>`;
            playerInfoContainer.appendChild(playerDiv);
        });
    }

    function setHostEmotion(emotion) {
        doomHost.classList.remove('happy', 'neutral', 'angry');
        doomHost.classList.add(emotion);
    }
    
    function startGame() {
        game.shuffledGameData = [...gameData]; 
        shuffleArray(game.shuffledGameData);
        game.usedQuestions.clear();
        startScreen.style.display = 'none';
        gameContainer.style.display = 'flex';
        hostSpeech.textContent = "Welcome to Absolute Zero!";
        setHostEmotion('neutral');
        startRound();
    }
    
    function generateChoices(correctAnswer, allAnswers) {
        let choices = [correctAnswer.answer];
        const distractors = allAnswers
            .filter(a => a.answer !== correctAnswer.answer)
            .map(a => a.answer);
            
        shuffleArray(distractors);
        
        while(choices.length < 6 && distractors.length > 0) {
            choices.push(distractors.pop());
        }
        
        shuffleArray(choices);
        return choices;
    }

    function startRound() {
        thermometerScoreText.classList.remove('show');
        thermometerFill.classList.remove('absolute-zero-flash');
        thermometerFill.style.height = '0%';
        thermometerFill.style.backgroundColor = 'var(--score-zero)';
        nextRoundBtn.style.display = 'none';
        setHostEmotion('neutral');
        game.currentPlayerIndex = 0;
        
        let availableQuestions = game.shuffledGameData.filter(q => !game.usedQuestions.has(q.question));
        if (availableQuestions.length === 0) {
            game.usedQuestions.clear();
            shuffleArray(game.shuffledGameData);
            availableQuestions = game.shuffledGameData;
        }
        
        const randomIndex = Math.floor(Math.random() * availableQuestions.length);
        game.currentQuestion = availableQuestions[randomIndex];
        game.usedQuestions.add(game.currentQuestion.question);
        
        roundStageText.textContent = `Stage ${game.currentStage}, Round ${game.currentRound}`;
        questionDisplay.textContent = game.currentQuestion.question;
        
        choiceButtonsDiv.innerHTML = '';
        const allAnswers = game.currentQuestion.answers;
        
        const correctAnswers = allAnswers.filter(a => a.score > 0);
        
        if (correctAnswers.length > 0) {
            const correctAnswer = correctAnswers[Math.floor(Math.random() * correctAnswers.length)];
            const choices = generateChoices(correctAnswer, allAnswers);
            
            choices.forEach(choiceText => {
                const button = document.createElement('button');
                button.textContent = choiceText;
                button.addEventListener('click', () => processAnswer(button.textContent));
                choiceButtonsDiv.appendChild(button);
            });
        }
        
        updateCurrentPlayerUI();
    }

    function updateCurrentPlayerUI() {
        const currentPlayer = game.players[game.currentPlayerIndex];
        currentPlayerText.textContent = `${currentPlayer.name}'s Turn`;
        hostSpeech.textContent = `Alright, ${currentPlayer.name}, make your choice!`;
        
        if (game.isAIGame && currentPlayer.name === "AI") {
            setTimeout(handleAIAnswer, 2000);
            disableChoiceButtons();
        } else {
            enableChoiceButtons();
        }
    }
    
    function disableChoiceButtons() {
        const buttons = choiceButtonsDiv.querySelectorAll('button');
        buttons.forEach(button => button.disabled = true);
    }
    
    function enableChoiceButtons() {
        const buttons = choiceButtonsDiv.querySelectorAll('button');
        buttons.forEach(button => button.disabled = false);
    }

    function processAnswer(answer) {
        disableChoiceButtons();
        
        const foundAnswer = game.currentQuestion.answers.find(ans => ans.answer === answer);
        
        let finalScore = 0;

        if (!foundAnswer) {
            finalScore = -100;
            hostSpeech.textContent = `That's incorrect! A penalty of 100 points!`;
            setHostEmotion('angry');
        } else {
            const modifier = Math.floor(Math.random() * 11) - 5;
            finalScore = foundAnswer.score + modifier;
            
            if (finalScore <= 0) {
                finalScore = 0;
                hostSpeech.textContent = `"${foundAnswer.answer}" is an Absolute Zero! Score: 0`;
                setHostEmotion('angry');
            } else {
                hostSpeech.textContent = `"${foundAnswer.answer}" is worth ${finalScore} points!`;
                if (finalScore > 60) {
                    setHostEmotion('happy');
                } else {
                    setHostEmotion('neutral');
                }
            }
        }
        showFinalScore(finalScore);
    }

    function showFinalScore(score) {
        if (game.currentPlayerIndex >= game.players.length) {
            console.error("Attempted to set score for an invalid player index.");
            return;
        }

        const fillHeight = Math.max(0, Math.min(100, score));
        const fillColor = getColorForScore(score);

        thermometerScoreText.textContent = score;
        thermometerScoreText.classList.add('show');
        thermometerFill.style.height = `${fillHeight}%`;
        thermometerFill.style.backgroundColor = fillColor;

        if (score === 0) {
             thermometerFill.classList.add('absolute-zero-flash');
        }

        const currentPlayer = game.players[game.currentPlayerIndex];
        currentPlayer.score += score;
        const scoreSpan = document.getElementById(`score-${sanitizeNameForId(currentPlayer.name)}`);
        scoreSpan.textContent = currentPlayer.score;

        setTimeout(nextPlayer, 2000);
    }

    function nextPlayer() {
        thermometerScoreText.classList.remove('show');
        thermometerFill.classList.remove('absolute-zero-flash');
        setHostEmotion('neutral');
        game.currentPlayerIndex++;
        if (game.currentPlayerIndex < game.players.length) {
            updateCurrentPlayerUI();
        } else {
            endRound();
        }
    }

    function endRound() {
        game.currentRound++;
        if (game.currentRound > 3) {
            game.currentRound = 1;
            game.currentStage++;
            showStageSummary();
        } else {
            nextRoundBtn.style.display = 'block';
            hostSpeech.textContent = "That's the end of the round. Click 'Next Round' to continue!";
        }
    }

    function showStageSummary() {
        const summaryScreen = document.createElement('div');
        summaryScreen.className = 'start-screen';
        summaryScreen.innerHTML = `
            <h2>Stage ${game.currentStage - 1} Complete!</h2>
            <div class="score-summary">
                <p>Final Scores for this Stage:</p>
                <ul>
                    ${game.players.map(p => `<li>${p.name}: ${p.score}</li>`).join('')}
                </ul>
            </div>
            <button id="next-stage-btn">Start Stage ${game.currentStage}</button>
        `;
        document.body.appendChild(summaryScreen);

        document.getElementById('next-stage-btn').addEventListener('click', () => {
            document.body.removeChild(summaryScreen);
            game.players.forEach(p => p.score = 0);
            updatePlayerInfoUI();
            startRound();
        });
    }

    function handleAIAnswer() {
        const choiceButtons = choiceButtonsDiv.querySelectorAll('button');
        const randomIndex = Math.floor(Math.random() * choiceButtons.length);
        const aiAnswer = choiceButtons[randomIndex].textContent;
        hostSpeech.textContent = `The AI chooses: ${aiAnswer}`;
        setTimeout(() => {
            processAnswer(aiAnswer);
        }, 1500);
    }
    
    start1pBtn.addEventListener('click', () => {
        game.isAIGame = true;
        setupPlayers(1);
        startGame();
    });
    
    start2pBtn.addEventListener('click', () => {
        game.isAIGame = false;
        playerNameInputsDiv.innerHTML = `
            <input type="text" id="p1-name" placeholder="Player 1 Name" value="Player 1">
            <input type="text" id="p2-name" placeholder="Player 2 Name" value="Player 2">
        `;
        playerNameInputsDiv.style.display = 'flex';
        startGameBtn.style.display = 'block';
    });

    start3pBtn.addEventListener('click', () => {
        game.isAIGame = false;
        playerNameInputsDiv.innerHTML = `
            <input type="text" id="p1-name" placeholder="Player 1 Name" value="Player 1">
            <input type="text" id="p2-name" placeholder="Player 2 Name" value="Player 2">
            <input type="text" id="p3-name" placeholder="Player 3 Name" value="Player 3">
        `;
        playerNameInputsDiv.style.display = 'flex';
        startGameBtn.style.display = 'block';
    });

    startGameBtn.addEventListener('click', () => {
        const nameInputs = playerNameInputsDiv.querySelectorAll('input');
        game.players = Array.from(nameInputs).map((input, index) => ({
            name: input.value || `Player ${index + 1}`,
            score: 0
        }));
        updatePlayerInfoUI(); 
        startGame();
    });

    nextRoundBtn.addEventListener('click', startRound);

    updatePlayerInfoUI();
</script>

</body>
</html>
